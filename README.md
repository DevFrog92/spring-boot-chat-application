# Spring Boot chat application

Redis와 Stomp를 이용한 기본적인 실시간 채팅 애플리케이션

### 주요 기능

- 사용자 기능
    - 회원가입한 사용자만 채팅 관련 기능을 사용할 수 있다.
    - 사용자는 로그아웃할 수 있다. 
- 실시간 채팅 기능
    - 채팅을 작성 및 전송할 수 있다.
- 채팅방 기능
    - 전체 채팅방 조회 기능
        - 메인 페이지에서 모든 채팅방을 볼 수 있다.
          - 만약 사용자가 특정 채팅방에 블랙리스트로 등록되어 있다면, 해당 채팅방은 제외되고 보여진다.
    - 채팅방 참여 기능
        - 회원가입 한 유저는 채팅방에 참여할 수 있다.
            - 프라이빗 채팅방의 경우 식별 코드가 반드시 입력되어야 한다.
        - 채팅방에 참여했다는 알림 메시지가 전송된다.
    - 채팅방 나가기 기능
        - 참여자는 채팅방을 나갈 수 있다.
        - 참여자가 나가면 채팅방에는 유저가 나갔다는 알림 메시지가 전송된다.
    - 채팅방 생성 기능
        - 채팅방 생성시 비밀번호를 통해서 프라이빗 채팅방을 개설할 수 있다.
        - 채팅방에 참여할 수 있는 식별 코드를 생성한다.
        - 회원가입한 유저만 채팅 방을 생성할 수 있다.
    - 채팅방 삭제 기능
        - 채팅방의 관리인은 채팅방을 삭제할 수 있다.
            - 만약 채팅방에 참여인원이 남아있으면 모든 인원을 내보내고, 채팅방은 삭제된다.
    - 방에서 강퇴 기능
        - 채팅방 관리자는 참여자를 강퇴시킬 수 있다.
        - 강퇴 당한 사용자는 블랙리스트에 추가된다.

### 메인 기술 스택

- Java 11
- Spring Boot 2.x.x
- WebSocket/Stomp
- JPA
- MySQL
- H2
- Redis Pub/Sub
- Spring Security
- Vue
- Freemarker

### ERD

<img src="https://github.com/DevFrog92/spring-boot-chat-application/assets/82052272/3aa7315a-ed8e-4ba8-9180-e433df9e579a" width="450">

### Diagram

<img src="https://github.com/DevFrog92/spring-boot-chat-application/assets/82052272/b086a4f8-140d-4382-914f-7d0bd782c495" width="450">

### Screenshot

- room
<br/>
<img src="https://github.com/DevFrog92/spring-boot-chat-application/assets/82052272/31898579-5ea6-4532-b67d-456bdd8c1e23" width="450">

- roomDetail
<br/>
<img src="https://github.com/DevFrog92/spring-boot-chat-application/assets/82052272/934a9619-d170-43cb-a1e6-6f89a34dbc46" width="450">


### 회고

#### 잘한것
- 처음으로 자바와 스프링부트를 활용해서 프로젝트를 진행했고, 직접 정한 2주의 기간안에 필수 기능을 모두 구현했다.
- 구현을 하면서 완벽주의에 빠지지 않기 위해서 노력했고, 할 수 있는 최선을 다해서 기간안에 기능 구현을 완료했다.
- 채팅 기능을 구현함에 있어서 레퍼런스를 단순히 따라 만든게 아니라, 온전히 이해하려고 노력했고, 변형해서 프로젝트 기능을 구현했다. 
그리고 스터디에서 해당 내용을 발표함으로써 채팅 애플리케이션의 구조를 다시 정리할 수 있었다.
- 채팅 서버를 구성하는데 있어서 Redis와 Kafka에 대해서 많은 고민을 하였다. 하지만 기술의 난이도와 기간안의 구현 목표를 위해서 적절한 기술 스택을 선택할 수 있었고, 결과적으로 만족한다.

#### 아쉬운것
- 채팅 기능 중, 사용자의 채팅 기록을 NoSQL인 MongoDB에 저장하고 싶었지만 구현하지 못했다. 
- 테스트 코드를 생각하지 못한채 개발을 진행해서, 1차 기능 구현 완료 후 더 많은 시간을 들여 아키텍쳐 변경 및 테스트 코드를 유연하게 작성할 수 있도록 리팩토링하였다.
- 객체지향에 대해서 공부했지만 아직은 객체의 협력관계와 적절한 책임을 할당하는 것에 많은 어려움을 느꼈다. 
- 처음 부터 좋은 설계, 완벽한 구현의 욕심을 쉽게 떨칠 수 없었고 이로 인해서 많은 시간이 낭비되었다.

#### 다음 스텝 
- 채팅 기능을 구현하면서 메시지 서버에 관심이 생겼다. 그리고 현재 가장 화두가 되고 있는 kafka와 SQS에 대해서 학습할 계획을 세웠고, kafka로 공부를 시작했다.
- 만약 인기있는 채팅방이 있고 많은 사람이 동시에 입장을 하려고 시도한다면 어떻게 대응해야할까? 상상해 보았고, 상상에 대한 해답을 찾기 위해서 테스트하는 방법과 동시성 이슈에 대해서 학습할 것이다.
- 객체지향에 대해서 학습하기 위해서 오브젝트 책의 공부를 시작했다.

#### 마치며
프로젝트를 개발하면서 2가지의 방향성을 잡을 수 있었다. 첫째는 변경에 유연하지만 견고한 설계이다. 두번째는 테스트가 쉬운 설계다. 흔히 말하는 SOLID 원칙, 응집도가 강하고 결합도가 느슨한 설계 등은 위의 방향성을 위한 조금 더 구체적인 길일지 모른다는 생각을 했다. 
앞으로는 더 2가지의 방향성에 초점을 두고 계속해서 걸어갈 것이다. 하지만 그 전에, 하나의 프로젝트를 동작할 수 있도록 기간안에 마무리 한 것은 너무 뿌듯하다. 😎

### Reference
- https://www.daddyprogrammer.org/post/4731/spring-websocket-chatting-server-redis-pub-sub/
